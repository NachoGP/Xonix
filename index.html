<html>

<head>
    <title>HTML5 XoniX</title>
    <meta name="robots" content="index, follow" />

    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="image_src" type="image/png" href="images/icon.png" />
    <link rel="stylesheet" type="text/css" href="style/reset.min.css">
    <link rel="stylesheet" type="text/css" href="style/style.css">

    <script type="text/javascript" src="scripts/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="scripts/event_handler.js"></script>
    <script type="text/javascript" src="scripts/movable.js"></script>
    <script type="text/javascript" src="scripts/vector.js"></script>
    <script type="text/javascript" src="scripts/grid.js"></script>
    <script type="text/javascript" src="scripts/ball.js"></script>
    <script type="text/javascript" src="scripts/monster.js"></script>
    <script type="text/javascript" src="scripts/player.js"></script>
    <script type="text/javascript" src="scripts/game.js"></script>
    
    <script>
        var canvasWidth = 640,
            canvasHeight = 460,
            frame = 20,
            blockSize = 10;
        var game;
        
        function updateScore(value) {
            $('#score').html(value);
        }
        function updateLives(value) {
            $('#lives').html(value);
        }
        function updateConquered(value) {
            $('#conqured').html(value);
        }
        function updateTimer(value) {
            $('#timer').html(value);
        }
        function gameOver(value) {
            
        }
        
        $(document).ready(function() {
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            
            var game = new Game(canvasHeight / blockSize, canvasWidth / blockSize, blockSize, frame / blockSize, ctx);            
            game.addEventListener('conquer', updateConquered, this);
            game.addEventListener('fail', updateLives, this);
            game.addEventListener('score', updateScore, this);
            game.addEventListener('end', gameOver, this);
            game.addEventListener('timer', updateTimer, this);
            game.start();
            
            var mute = game.get_mute();            
            $('#mute').addClass(mute ? "on" : "off");
            
            $('#mute').click(function () {
                game.toggleMute();
                mute = !mute;
                $('#mute').removeClass("on").removeClass("off");
                $('#mute').addClass(mute ? "on" : "off");
            });
            
            /*setInterval(function() {var text = $('#cursor').text(); text == "_" ? $('#cursor').text("") : $('#cursor').text("_");  }, 300);
            
            $(document).bind('keypress', function(e) {
                if ($('#user_name').text().length < 20) {
                    $('#user_name').text( $('#user_name').text() + String.fromCharCode(e.which));
                }
            });
            $(document).bind('keydown', function(e) { if (e.which == 8) { $('#user_name').text( $('#user_name').text().substr(0, $('#user_name').text().length - 1) ) }});*/
        });
    </script>
</head>

<body>
    <div id="fb-root"></div>
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId  : '295068687232226',
          status : true,
          cookie : true,
          xfbml  : true
        });
      };
    
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/en_US/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));
    </script>
    
    <div id="container">
        <div id="header">
            <a href="/" class="xonix">XONIX</a>            
            <div class="like">
                <iframe src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Fapps.facebook.com%2Fxonix_classic%2F&amp;send=false&amp;layout=button_count&amp;width=90&amp;show_faces=false&amp;action=like&amp;colorscheme=dark&amp;font=verdana&amp;height=21&amp;appId=295068687232226" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90px; height:21px;" allowTransparency="true"></iframe>
            </div>
        </div>
        <div id="mute"></div>
        <canvas id="canvas" width="640" height="460"></canvas>
        <div id="status">
            <label class="score">Score: <span id="score">0</span></label>
            <label class="lives">Xn: <span id="lives">3</span></label>
            <label class="conqured">Full: <span id="conqured">0</span>%</label>
            <label class="timer">Time: <span id="timer">90</span></label>
        </div>
        
        <div id="footer">
            Created by Yair Levinson and Roei Oved @ 2012
            <br/>
            Originality created by Ilan Rav and Dani Katz @ 1984
        </div>
    </div>
</body>

</html>